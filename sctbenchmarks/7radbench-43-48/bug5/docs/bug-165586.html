<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

  
    <title>Bug 165586 – pthreads: PR_Interrupt may not interrupt PR_WaitCondVar (the join test hangs)</title>


<link rel="Top" href="https://bugzilla.mozilla.org/">

  


  
    <link rel="Show" title="Dependency Tree" href="https://bugzilla.mozilla.org/showdependencytree.cgi?id=165586&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph" href="https://bugzilla.mozilla.org/showdependencygraph.cgi?id=165586">

      <link rel="Show" title="Votes (0)" href="https://bugzilla.mozilla.org/votes.cgi?action=show_bug&amp;bug_id=165586">

      <link rel="Show" title="Bug Activity" href="https://bugzilla.mozilla.org/show_activity.cgi?id=165586">
      <link rel="Show" title="Printer-Friendly Version" href="https://bugzilla.mozilla.org/show_bug.cgi?format=multiple&amp;id=165586">


  
    <link rel="Saved&nbsp;Searches" title="My Bugs" href="https://bugzilla.mozilla.org/buglist.cgi?bug_status=UNCONFIRMED&amp;bug_status=NEW&amp;bug_status=ASSIGNED&amp;bug_status=REOPENED&amp;emailassigned_to1=1&amp;emailreporter1=1&amp;emailtype1=exact&amp;email1=naj5c%40virginia.edu&amp;field0-0-0=bug_status&amp;type0-0-0=notequals&amp;value0-0-0=UNCONFIRMED&amp;field0-0-1=reporter&amp;type0-0-1=equals&amp;value0-0-1=naj5c%40virginia.edu">


    


        <link rel="stylesheet" type="text/css" href="bug-165586_files/autocomplete.css">
        <link rel="stylesheet" type="text/css" href="bug-165586_files/calendar.css">

    
      <link href="bug-165586_files/global_003.css" rel="stylesheet" type="text/css">
      <link href="bug-165586_files/show_bug.css" rel="stylesheet" type="text/css">
    <!--[if lte IE 7]>
      
      <link href="skins/standard/IE-fixes.css"
            rel="stylesheet"
            type="text/css">
    <![endif]-->

    
        <link href="bug-165586_files/global_003.css" rel="stylesheet" title="Classic" type="text/css">
        <link href="bug-165586_files/show_bug.css" rel="stylesheet" title="Classic" type="text/css">
      <!--[if lte IE 7]>
      
        <link href="skins/standard/IE-fixes.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
      <![endif]-->

    
        
            <link href="bug-165586_files/global_004.css" rel="alternate stylesheet" title="BMO" type="text/css">
            <link href="bug-165586_files/show_bug_004.css" rel="alternate stylesheet" title="BMO" type="text/css">
        <!--[if lte IE 7]>
          
          <link href="skins/contrib/BMO/IE-fixes.css"
                rel="alternate stylesheet"
                title="BMO"
                type="text/css">
        <![endif]-->
        
            <link href="bug-165586_files/global.css" rel="alternate stylesheet" title="Dusk" type="text/css">
            <link href="bug-165586_files/show_bug_003.css" rel="alternate stylesheet" title="Dusk" type="text/css">
        <!--[if lte IE 7]>
          
          <link href="skins/contrib/Dusk/IE-fixes.css"
                rel="alternate stylesheet"
                title="Dusk"
                type="text/css">
        <![endif]-->

    

    
        <link href="bug-165586_files/global_002.css" rel="stylesheet" type="text/css">
        <link href="bug-165586_files/show_bug_002.css" rel="stylesheet" type="text/css">
    <!--[if lte IE 7]>
      
      <link href="skins/custom/IE-fixes.css"
            rel="stylesheet"
            type="text/css">
    <![endif]-->

    
    <script src="bug-165586_files/yahoo-dom-event.js" type="text/javascript"></script>
    <script src="bug-165586_files/cookie-min.js" type="text/javascript"></script>
    
      <script type="text/javascript" src="bug-165586_files/json-min.js"></script>
      <script type="text/javascript" src="bug-165586_files/connection-min.js"></script>
      <script type="text/javascript" src="bug-165586_files/datasource-min.js"></script>
      <script type="text/javascript" src="bug-165586_files/autocomplete-min.js"></script>
      <script type="text/javascript" src="bug-165586_files/calendar-min.js"></script>

    <script src="bug-165586_files/global.js" type="text/javascript"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        if (YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 100
            },

            string: {
                attach_desc_required:
                    'You must enter a Description for this attachment.'
            }
        };
    // -->
    </script>

        <script src="bug-165586_files/util.js" type="text/javascript"></script>
        <script src="bug-165586_files/field.js" type="text/javascript"></script>

    


    
    <link rel="search" type="application/opensearchdescription+xml" title="Bugzilla@Mozilla" href="https://bugzilla.mozilla.org/search_plugin.cgi"><link rel="shortcut icon" href="https://bugzilla.mozilla.org/skins/custom/images/bugzilla.png">
    <link id="shorturl" rev="canonical" href="http://bugzil.la/165586">
  </head><body onload="" class="bugzilla-mozilla-org bz_bug bz_status_NEW bz_product_NSPR bz_component_NSPR bz_bug_165586 yui-skin-sam">



<div id="header">
<div id="banner">
  </div>

<table id="titles" border="0" cellpadding="0" cellspacing="0">
<tbody><tr>
    <td id="title">
      <p>Bugzilla@Mozilla – Bug&nbsp;165586</p>
    </td>

    <td id="subtitle">
      <p class="subheader">pthreads: PR_Interrupt may not interrupt PR_WaitCondVar (the join test hangs)</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2007-05-08 17:40:45 PDT</p>
    </td>
</tr>
</tbody></table>

<table id="lang_links_container" cellpadding="0" cellspacing="0"><tbody><tr><td>
</td></tr></tbody></table>
<ul class="links">
  <li><a href="https://bugzilla.mozilla.org/">Home</a></li>
  <li><span class="separator">| </span><a href="https://bugzilla.mozilla.org/enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="https://bugzilla.mozilla.org/describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="https://bugzilla.mozilla.org/query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get" onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input class="txt" id="quicksearch_top" name="quicksearch" type="text">
    <input class="btn" value="Search" id="find_top" type="submit"></form>
  <a href="https://bugzilla.mozilla.org/page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="https://bugzilla.mozilla.org/report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="https://bugzilla.mozilla.org/request.cgi?requester=naj5c%40virginia.edu&amp;requestee=naj5c%40virginia.edu&amp;do_union=1&amp;group=type&amp;action=queue">My Requests</a></li>

    <li><span class="separator">| </span><a href="https://bugzilla.mozilla.org/userprefs.cgi">Preferences</a></li>
<li>
        <span class="separator">| </span>
        <a href="http://www.bugzilla.org/docs/3.6/en/html/bug_page.html" target="_blank">Help</a>
      </li>

    <li>
      <span class="separator">| </span>
        <a href="https://bugzilla.mozilla.org/index.cgi?logout=1">Log&nbsp;out</a>
        naj5c@virginia.edu</li>
</ul>
</div> 

<div id="bugzilla-body">
<!-- <div style="border: 2px dotted red;">
<p style="padding: 5px; margin: 0px; color: red; text-align: center;">Bugzilla will be offline for up to 30 minutes starting at 6pm PDT (0100 UTC) for a kernel update and RAM upgrade on its master database server.</p>
</div>
<br> -->

<div class="navigation">
  <b>Bug List:</b>


      (This bug is not in your last search results)

  &nbsp;&nbsp;<a href="https://bugzilla.mozilla.org/buglist.cgi?regetlastlist=1">Show last search results</a>
</div>
<script type="text/javascript">
  <!--
  
  /* Outputs a link to call replyToComment(); used to reduce HTML output */
  function addReplyLink(id, real_id) {
      /* XXX this should really be updated to use the DOM Core's
       * createElement, but finding a container isn't trivial.
       */
        document.write('[<a href="#add_comment" onclick="replyToComment(' + 
                       id + ',' + real_id + '); return false;">reply<' + '/a>]');
  }

  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id) {
      var prefix = "(In reply to comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);

        /* make sure we split on all newlines -- IE or Moz use \r and \n
         * respectively.
         */
        text = text.split(/\r|\n/);

        for (var i=0; i < text.length; i++) {
            replytext += "> " + text[i] + "\n"; 
        }

        replytext = prefix + replytext + "\n";


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      textarea.value += replytext;

      textarea.focus();
  }

  if (typeof Node == 'undefined') {
      /* MSIE doesn't define Node, so provide a compatibility object */
      window.Node = {
          TEXT_NODE: 3,
          ENTITY_REFERENCE_NODE: 5
      };
  }

  /* Concatenates all text from element's childNodes. This is used
   * instead of innerHTML because we want the actual text (and
   * innerText is non-standard).
   */
  function getText(element) {
      var child, text = "";
      for (var i=0; i < element.childNodes.length; i++) {
          child = element.childNodes[i];
          var type = child.nodeType;
          if (type == Node.TEXT_NODE || type == Node.ENTITY_REFERENCE_NODE) {
              text += child.nodeValue;
          } else {
              /* recurse into nodes of other types */
              text += getText(child);
          }
      }
      return text;
  }


  //-->
  </script>

<form name="changeform" method="post" action="process_bug.cgi">

  <input name="delta_ts" value="2007-05-08 17:40:45" type="hidden">
  <input name="longdesclength" value="5" type="hidden">
  <input name="id" value="165586" type="hidden">
  <input name="token" value="1283980151-9038a165343a6d815c7f7458566c5edc" type="hidden">
<div class="bz_alias_short_desc_container edit_form">
    <span class="last_comment_link">
      <a href="#c4" accesskey="l"><b>L</b>ast Comment</a>
    </span>
     <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=165586"><b>Bug&nbsp;165586</b></a> -<span id="summary_alias_container"> 
      <span id="short_desc_nonedit_display">pthreads: PR_Interrupt may not interrupt PR_WaitCondVar (the join test hangs)</span>
     </span>
  
       
    <div class="bz_default_hidden" id="summary_alias_input">
      <table id="summary"> 
          <tbody><tr>
            <td colspan="2">
          </td>
        </tr> 
        
        <tr>
          <td>
            <label accesskey="s" for="short_desc"><u>S</u>ummary</label>:
          </td>
          <td>pthreads: PR_Interrupt may not interrupt PR_WaitCondVar (the join test hangs)
          </td>
        </tr>
      </tbody></table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('pthreads: PR_Interrupt may not interrupt PR_WaitCondVar (the join test hangs)', '');
  </script>
  <table class="edit_form">
    <tbody><tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table class="bz_show_bug_column_table">
          <tbody><tr>
    <td class="field_label">
      <b><a href="https://bugzilla.mozilla.org/page.cgi?id=fields.html#status">Status</a></b>:
    </td>
    <td id="bz_field_status">
      <span id="static_bug_status">NEW
      </span>
    </td>
  </tr>
    <tr>
      <td class="field_label">
        <label for="status_whiteboard" accesskey="w"><b><u>W</u>hiteboard</b></label>:
      </td><td colspan="2">qa  
  </td>
    </tr>
  
    <tr>
      <td class="field_label">
        <label for="keywords" accesskey="k">
          <b><a href="https://bugzilla.mozilla.org/describekeywords.cgi"><u>K</u>eywords</a></b></label>:
      </td>
      <td class="field_value" colspan="2">
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label " id="field_label_product">
        <a href="https://bugzilla.mozilla.org/describecomponents.cgi">Product:</a>
  </th>

<td class="field_value " id="field_container_product">NSPR</td>
    </tr>
        
    
    
    <tr>
      <td class="field_label">
        <label for="component" accesskey="m">
          <b><a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=NSPR">
            Co<u>m</u>ponent</a>:
          </b>
        </label>
      </td><td>NSPR
  </td>
    </tr>
    <tr>
      <td class="field_label">
        <label for="version"><b>Version</b></label>:
      </td>
<td>4.2
  </td>
    </tr>
        
    
        
    <tr>
      <td class="field_label">
        <label for="rep_platform" accesskey="h"><b>Platform</b></label>:
      </td>
      <td class="field_value">x86
       Linux
       <script type="text/javascript">
         assignToDefaultOnChange(['product', 'component']);
       </script>
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <td class="field_label">
        <label for="priority" accesskey="i">
          <b><a href="https://bugzilla.mozilla.org/page.cgi?id=fields.html#importance"><u>I</u>mportance</a></b></label>:
      </td>
      <td>P2
       normal
          <span id="votes_container">    
          (<a href="https://bugzilla.mozilla.org/votes.cgi?action=show_user&amp;bug_id=165586#vote_165586">vote</a>)
          </span>  
      </td>
    </tr>

      <tr>
        <td class="field_label">
          <label for="target_milestone">
              <a href="https://bugzilla.mozilla.org/page.cgi?id=fields.html#target_milestone">
            Target&nbsp;Milestone</a></label>:
        </td><td>---
  </td>
      </tr>            
          
          <tr>
      <td class="field_label">
        <b><a href="https://bugzilla.mozilla.org/page.cgi?id=fields.html#assigned_to">Assigned To</a></b>:
      </td>
      <td><span class="vcard"><a class="email" href="mailto:wtc@google.com" title="Wan-Teh Chang &lt;wtc@google.com&gt;"> <span class="fn">Wan-Teh Chang</span></a>
</span>
      </td>
    </tr>

    <tr>
      <td class="field_label">
        <label for="qa_contact" accesskey="q"><b><u>Q</u>A Contact</b></label>:
      </td>
      <td><span class="vcard"><a class="email" href="mailto:nspr@nspr.bugs" title="nspr@nspr.bugs">nspr@nspr.bugs</a>
</span>
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr>
    <td class="field_label">
      <label for="bug_file_loc" accesskey="u"><b>
          <u>U</u>RL</b></label>:
    </td>
    <td>
      <span id="bz_url_input_area">
          <a href=""></a>
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr><th class="field_label">
    <label for="dependson">Depends&nbsp;on</label>:
  </th>
  <td>    
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label">
    <label for="blocked" accesskey="b"><u>B</u>locks</label>:
  </th>
  <td>    
    <span id="blocked_input_area">
    </span>
    
  </td>
  
  </tr><tr>
    <th>&nbsp;</th>
  
    <td colspan="2" id="show_dependency_tree_or_graph" align="left">
      Show dependency <a href="https://bugzilla.mozilla.org/showdependencytree.cgi?id=165586&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="https://bugzilla.mozilla.org/showdependencygraph.cgi?id=165586">graph</a>
    </td>
  </tr>
          
            <tr>
              <td colspan="2"><div class="knob-buttons">
      <input value="Save Changes" id="commit_top" type="submit">
    </div>
              </td>
            </tr>
        </tbody></table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table class="bz_show_bug_column_table" cellpadding="3" cellspacing="1">
        <tbody><tr>
    <td class="field_label">
      <b>Reported</b>:
    </td>
    <td>2002-08-29 16:08 PDT by <span class="vcard"><a class="email" href="mailto:wtc@google.com" title="Wan-Teh Chang &lt;wtc@google.com&gt;"> <span class="fn">Wan-Teh Chang</span></a>
</span>
    </td>
  </tr>
  
  <tr>
    <td class="field_label">
      <b> Modified</b>:
    </td>
    <td>2007-05-08 17:40 PDT 
      (<a href="https://bugzilla.mozilla.org/show_activity.cgi?id=165586">History</a>)
    </td>
  
  </tr>
         <tr>
      <td class="field_label">
        <label for="newcc" accesskey="a"><b>CC List</b>:</label>
      </td>
      <td>
            <input id="addselfcc" name="addselfcc" checked="checked" type="checkbox">
            <label for="addselfcc">Add me to CC list</label>
            <br> 1 
          user
        <span id="cc_edit_area_showhide_container">
          (<a href="#" id="cc_edit_area_showhide">edit</a>)
            <div id="cc_list_num_users">
              <ul class="cc_list_display"> 
                  <li>crumley@fields.space.umn.edu</li>
              </ul>
            </div>
        </span>
        <div class="bz_default_hidden" id="cc_edit_area">
            <div>
              <div><label for="cc"><b>Add</b></label></div><div class="yui-ac" id="newcc_autocomplete">  
  <input autocomplete="off" class="yui-ac-input" name="newcc" size="30" id="newcc">
    <div class="yui-ac-container" id="newcc_autocomplete_container"><div style="display: none;" class="yui-ac-content"><div style="display: none;" class="yui-ac-hd"></div><div class="yui-ac-bd"><ul><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li><li style="display: none;"></li></ul></div><div style="display: none;" class="yui-ac-ft"></div></div></div>
    </div>  
    <script type="text/javascript">
      if( typeof(YAHOO.bugzilla.userAutocomplete) !== 'undefined' 
          && YAHOO.bugzilla.userAutocomplete != null){
        YAHOO.bugzilla.userAutocomplete.init( "newcc", 
                    "newcc_autocomplete_container", true);        
      }
    </script>
            </div>
            <select id="cc" name="cc" multiple="multiple" size="5">
                <option value="crumley@fields.space.umn.edu">crumley@fields.space.umn.edu</option>
            </select>
              <br>
              <input id="removecc" name="removecc" type="checkbox"><label for="removecc">Remove selected CCs</label>
              <br>
        </div>
        <script type="text/javascript">
          hideEditableField( 'cc_edit_area_showhide_container', 
                             'cc_edit_area', 
                             'cc_edit_area_showhide', 
                             '', 
                             '');  
        </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

<tr><th class="field_label " id="field_label_see_also">
        <a href="https://bugzilla.mozilla.org/page.cgi?id=fields.html#see_also">See Also:</a>
  </th>

<td class="field_value " id="field_container_see_also"></td>
    </tr> 
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label " id="field_label_cf_blocking_fennec">blocking-fennec:
  </th>

<td class="field_value " id="field_container_cf_blocking_fennec" colspan="2">---</td>
    </tr>
    <tr><th class="field_label " id="field_label_cf_blocking_20">blocking2.0:
  </th>

<td class="field_value " id="field_container_cf_blocking_20" colspan="2">---</td>
    </tr>
    <tr><th class="field_label " id="field_label_cf_status_20">status2.0:
  </th>

<td class="field_value " id="field_container_cf_status_20" colspan="2">---</td>
    </tr>
    <tr><th class="field_label " id="field_label_cf_blocking_192">blocking1.9.2:
  </th>

<td class="field_value " id="field_container_cf_blocking_192" colspan="2">---</td>
    </tr>
    <tr><th class="field_label " id="field_label_cf_status_192">status1.9.2:
  </th>

<td class="field_value " id="field_container_cf_status_192" colspan="2">---</td>
    </tr>
    <tr><th class="field_label " id="field_label_cf_blocking_191">blocking1.9.1:
  </th>

<td class="field_value " id="field_container_cf_blocking_191" colspan="2">---</td>
    </tr>
    <tr><th class="field_label " id="field_label_cf_status_191">status1.9.1:
  </th>

<td class="field_value " id="field_container_cf_status_191" colspan="2">---</td>
    </tr>
         

        </tbody></table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </tbody></table>

  <table id="bz_big_form_parts" cellpadding="0" cellspacing="0"><tbody><tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
    }
    else {
        link.innerHTML = "Hide Obsolete";
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellpadding="4" cellspacing="0">
  <tbody><tr>
    <th colspan="3" align="left">
      <a name="a0" id="a0">Attachments</a>
    </th>
  </tr>


      <tr class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a name="a1" href="https://bugzilla.mozilla.org/attachment.cgi?id=97240" title="View the content of the attachment">
          <b>For testing: a patch for NSPR that makes it easy to reproduce the bug with the join test</b></a>

          <span class="bz_attach_extra_info">
              (1.14 KB,
                patch)

            <br>
            <a href="#attach_97240" title="Go to the comment associated with the attachment">2002-08-29 16:32 PDT</a>,
<span class="vcard"><a class="email" href="mailto:wtc@google.com" title="Wan-Teh Chang &lt;wtc@google.com&gt;"> <span class="fn">Wan-Teh Chang</span></a>
</span>
          </span>
        </td>

          <td class="bz_attach_flags" valign="top">
              <i>no flags</i>
          </td>

        <td valign="top">
          <a href="https://bugzilla.mozilla.org/attachment.cgi?id=97240&amp;action=edit">Details</a>
            | <a href="https://bugzilla.mozilla.org/attachment.cgi?id=97240&amp;action=diff">Diff</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="3">
        <span class="bz_attach_view_hide">
            <a href="https://bugzilla.mozilla.org/attachment.cgi?bugid=165586&amp;action=viewall">View All</a>
        </span>
      <a href="https://bugzilla.mozilla.org/attachment.cgi?bugid=165586&amp;action=enter">Add an attachment</a>
      (proposed patch, testcase, etc.)
    </td>
  </tr>
</tbody></table>
<br>

  </td>
  <td>
  </td>
  </tr></tbody></table>

  

  
  <div id="comments"><script type="text/javascript">
  <!--
  function updateCommentPrivacy(checkbox, id) {
    var comment_elem = document.getElementById('comment_text_'+id).parentNode;
    if (checkbox.checked) {
      if (!comment_elem.className.match('bz_private')) {
        comment_elem.className = comment_elem.className.concat(' bz_private');
      }
    }
    else {
      comment_elem.className =
        comment_elem.className.replace(/(\s*|^)bz_private(\s*|$)/, '$2');
    }
  }

  /* The functions below expand and collapse comments  */

  function toggle_comment_display(link, comment_id) {
    var comment = document.getElementById('comment_text_' + comment_id);
    var re = new RegExp(/\bcollapsed\b/);
    if (comment.className.match(re))
        expand_comment(link, comment);
    else
        collapse_comment(link, comment);
  }

  function toggle_all_comments(action) {
    var num_comments = 5;

    // If for some given ID the comment doesn't exist, this doesn't mean
    // there are no more comments, but that the comment is private and
    // the user is not allowed to view it.

    for (var id = 0; id < num_comments; id++) {
        var comment = document.getElementById('comment_text_' + id);
        if (!comment)
            continue;

        var link = document.getElementById('comment_link_' + id);
        if (action == 'collapse')
            collapse_comment(link, comment);
        else
            expand_comment(link, comment);
    }
  }

  function collapse_comment(link, comment) {
    link.innerHTML = "[+]";
    link.title = "Expand the comment.";
    YAHOO.util.Dom.addClass(comment, 'collapsed');
  }

  function expand_comment(link, comment) {
    link.innerHTML = "[-]";
    link.title = "Collapse the comment";
    YAHOO.util.Dom.removeClass(comment, 'collapsed');
  }

  /* This way, we are sure that browsers which do not support JS
   * won't display this link  */

  function addCollapseLink(count) {
    document.write(' <a href="#" class="bz_collapse_comment"' +
                   ' id="comment_link_' + count +
                   '" onclick="toggle_comment_display(this, ' +  count +
                   '); return false;" title="Collapse the comment.">[-]<\/a> ');
  }
  //-->
  </script>










<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tbody><tr>
<td>
<div class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">

          <span class="bz_comment_actions">
            <script type="text/javascript"><!--
              addReplyLink(0, 1519878);
              addCollapseLink(0); // -->
            </script>[<a href="#add_comment" onclick="replyToComment(0,1519878); return false;">reply</a>] <a href="#" class="bz_collapse_comment" id="comment_link_0" onclick="toggle_comment_display(this, 0); return false;" title="Collapse the comment.">[-]</a> 
          </span>


        <span class="bz_comment_number">
          <a name="c0" href="https://bugzilla.mozilla.org/show_bug.cgi?id=165586#c0">Description</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><a class="email" href="mailto:wtc@google.com" title="Wan-Teh Chang &lt;wtc@google.com&gt;"> <span class="fn">Wan-Teh Chang</span></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2002-08-29 16:08:33 PDT
        </span>
      </div>



<pre class="bz_comment_text" id="comment_text_0">This bug affects the pthreads version of NSPR, which
is used on most Unix platforms.

There is a race condition when we use PR_Interrupt to
interrupt PR_WaitCondVar.

Suppose thread A is calling PR_WaitCondVar and thread
B is interrupting thread A.  The following event
sequence is problematic.

Thread A                     Thread B
==========================   ========================
Test its interrupt flag

Set thred-&gt;waiting to cvar

                             Set thread A's interrupt
                             flag

                             Call pthread_cond_broadcast
                             on thread A's 'waiting'
                             cvar

Call pthread_cond_wait

=====================================================

Thread A misses the broadcast and blocks in
pthread_cond_wait forever.

This can be reproduced with the 'join' test program,
at least on Red Hat Linux 6.2.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">

          <span class="bz_comment_actions">
            <script type="text/javascript"><!--
              addReplyLink(1, 1519941);
              addCollapseLink(1); // -->
            </script>[<a href="#add_comment" onclick="replyToComment(1,1519941); return false;">reply</a>] <a href="#" class="bz_collapse_comment" id="comment_link_1" onclick="toggle_comment_display(this, 1); return false;" title="Collapse the comment.">[-]</a> 
          </span>


        <span class="bz_comment_number">
          <a name="c1" href="https://bugzilla.mozilla.org/show_bug.cgi?id=165586#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><a class="email" href="mailto:wtc@google.com" title="Wan-Teh Chang &lt;wtc@google.com&gt;"> <span class="fn">Wan-Teh Chang</span></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2002-08-29 16:32:05 PDT
        </span>
      </div>



<pre class="bz_comment_text" id="comment_text_1">Created <span class=""><a href="https://bugzilla.mozilla.org/attachment.cgi?id=97240&amp;action=diff" name="attach_97240" title="For testing: a patch for NSPR that makes it easy to reproduce the bug with the join test">attachment 97240</a> <a href="https://bugzilla.mozilla.org/attachment.cgi?id=97240&amp;action=edit" title="For testing: a patch for NSPR that makes it easy to reproduce the bug with the join test">[details]</a></span>
For testing: a patch for NSPR that makes it easy to reproduce the bug with the join test

Apply the patch to mozilla/nsprpub.  It inserts
a 2 second delay to PR_WaitCondVar after it sets
thred-&gt;waiting to cvar and inserts a 1 second delay
to the very beginning of PR_Interrupt.

With the patched NSPR library, run the 'join' test.
The events will happen at the following time instants:

Thread A		      Thread B
===========================   ========================
T0: Test its interrupt flag   T0: Sleep 1 second

T0: Set thred-&gt;waiting to
cvar

T0: Sleep 2 seconds
			      
			      T1: Set thread A's interrupt
			      flag

			      T1: Call pthread_cond_broadcast
			      on thread A's 'waiting' cvar

T2: Call pthread_cond_wait</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">

          <span class="bz_comment_actions">
            <script type="text/javascript"><!--
              addReplyLink(2, 1575520);
              addCollapseLink(2); // -->
            </script>[<a href="#add_comment" onclick="replyToComment(2,1575520); return false;">reply</a>] <a href="#" class="bz_collapse_comment" id="comment_link_2" onclick="toggle_comment_display(this, 2); return false;" title="Collapse the comment.">[-]</a> 
          </span>


        <span class="bz_comment_number">
          <a name="c2" href="https://bugzilla.mozilla.org/show_bug.cgi?id=165586#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><a class="email" href="mailto:wtc@google.com" title="Wan-Teh Chang &lt;wtc@google.com&gt;"> <span class="fn">Wan-Teh Chang</span></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2002-10-05 07:18:37 PDT
        </span>
      </div>



<pre class="bz_comment_text" id="comment_text_2">This bug can also be reproduced rather easily
with the 'join' test program on Mac OS X.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">

          <span class="bz_comment_actions">
            <script type="text/javascript"><!--
              addReplyLink(3, 1868642);
              addCollapseLink(3); // -->
            </script>[<a href="#add_comment" onclick="replyToComment(3,1868642); return false;">reply</a>] <a href="#" class="bz_collapse_comment" id="comment_link_3" onclick="toggle_comment_display(this, 3); return false;" title="Collapse the comment.">[-]</a> 
          </span>


        <span class="bz_comment_number">
          <a name="c3" href="https://bugzilla.mozilla.org/show_bug.cgi?id=165586#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><a class="email" href="mailto:crumley@fields.space.umn.edu" title="Jim Crumley &lt;crumley@fields.space.umn.edu&gt;"> <span class="fn">Jim Crumley</span></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2003-06-02 14:32:53 PDT
        </span>
      </div>



<pre class="bz_comment_text" id="comment_text_3">I am seeing a problem which may be related to this bug, though I don't know
enough about threads to be sure.  

I am getting frequents hangs of Mozilla where it will not respond at all if I
open up several pages in new tabs in the background in quick succession. I
first noticed this problem with Mozilla 1.4 beta, but I have now reproduced it
with 1.4rc and 1.0.0 under Linux as well.

Here's a copy of the the backtrace I get after I get this hang from 1.4rc:
#0  0x403b6ae2 in sigsuspend () from /lib/libc.so.6
#1  0x400d6f35 in __pthread_wait_for_restart_signal ()
   from /lib/libpthread.so.0
#2  0x400d3f05 in pthread_cond_wait () from /lib/libpthread.so.0
#3  0x400af15e in PR_WaitCondVar () from /usr/local/mozilla/libnspr4.so
#4  0x4057c8ee in nsThreadPool::GetRequest ()
   from /usr/local/mozilla/libxpcom.so
#5  0x4057d060 in nsThreadPoolRunnable::Run ()
   from /usr/local/mozilla/libxpcom.so
#6  0x4057b9bd in nsThread::Main () from /usr/local/mozilla/libxpcom.so
#7  0x400b42b9 in PR_Select () from /usr/local/mozilla/libnspr4.so
#8  0x400d4d53 in pthread_start_thread () from /lib/libpthread.so.0
#9  0x400d4d99 in pthread_start_thread_event () from /lib/libpthread.so.0

The backtrace is essentially the same for 1.0.0.

I am not sure what I have changed about my system that has caused this problem
to only startup recently - within the past month.  My guess are libc6 or the
kernel.  I am now running Linux kernel 2.5.69 and libc6 2.3.1-16 from Debian
testing.

Since the backtrace involved pthreads and the interrupt and wait conditions
mentioned in this bug, it seems that my problem might be related.  If you don't
think so, let me know and I'll open up a new bug.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">

          <span class="bz_comment_actions">
            <script type="text/javascript"><!--
              addReplyLink(4, 1868823);
              addCollapseLink(4); // -->
            </script>[<a href="#add_comment" onclick="replyToComment(4,1868823); return false;">reply</a>] <a href="#" class="bz_collapse_comment" id="comment_link_4" onclick="toggle_comment_display(this, 4); return false;" title="Collapse the comment.">[-]</a> 
          </span>


        <span class="bz_comment_number">
          <a name="c4" href="https://bugzilla.mozilla.org/show_bug.cgi?id=165586#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><a class="email" href="mailto:wtc@google.com" title="Wan-Teh Chang &lt;wtc@google.com&gt;"> <span class="fn">Wan-Teh Chang</span></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2003-06-02 16:53:16 PDT
        </span>
      </div>



<pre class="bz_comment_text" id="comment_text_4">You should open a new bug.  PR_Interrupt is
only used when shutting down a nsThreadPool.
I am not sure if PR_Interrupt is involved in
the hang you are seeing.</pre>
    </div>
  

  

</td>
<td>
    <ul class="bz_collapse_expand_comments">
      <li><a href="#" onclick="toggle_all_comments('collapse'); 
                               return false;">Collapse All Comments</a></li>
      <li><a href="#" onclick="toggle_all_comments('expand');
                               return false;">Expand All Comments</a></li>
    </ul>
</td>
</tr></tbody></table>
  </div>

    <hr><div class="bz_section_additional_comments">
    <a name="add_comment"></a>
      <label for="comment" accesskey="c"><b>Additional 
        <u>C</u>omments</b></label>:


      <!-- This table keeps the submit button aligned with the box. -->
      <table><tbody><tr><td><textarea name="comment" id="comment" rows="10" cols="80"></textarea>
        <br><div class="knob-buttons">
      <input value="Save Changes" id="commit" type="submit">
    </div>

        <table class="status" cellpadding="0" cellspacing="0">
          <tbody><tr>
            <td class="field_label">
              <b><a href="https://bugzilla.mozilla.org/page.cgi?id=fields.html#status">Status</a></b>:
            </td>
            <td>
              <a name="bug_status_bottom"></a><div id="status">NEW


  <span id="resolution_settings">
  </span>

</div>

<script type="text/javascript">
  var close_status_array = [
  ];
  YAHOO.util.Dom.removeClass('dup_id_discoverable', 'bz_default_hidden');
  hideEditableField( "dup_id_container", "dup_id", 'dup_id_edit_action',
                     'dup_id', '' )
  showHideStatusItems( "",  ['',
                             'NEW']);
  YAHOO.util.Event.addListener( 'bug_status', "change", showHideStatusItems,
                                ['',
                                 'NEW']);
  YAHOO.util.Event.addListener( 'resolution', "change", showDuplicateItem);
  YAHOO.util.Event.addListener( 'dup_id_discoverable_action',
                                'click',
                                setResolutionToDuplicate,
                                'RESOLVED');
  YAHOO.util.Event.addListener( window, 'load',  showHideStatusItems,
                              ['',
                               'NEW'] );

</script>
            </td>
          </tr>
        </tbody></table>
      </td></tr></tbody></table>

    
  </div>

</form>

<hr>
<ul class="related_actions">
    <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?format=multiple&amp;id=165586">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="https://bugzilla.mozilla.org/show_bug.cgi?ctype=xml&amp;id=165586">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="https://bugzilla.mozilla.org/enter_bug.cgi?cloned_bug_id=165586">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  <b>Bug List:</b>


      (This bug is not in your last search results)

  &nbsp;&nbsp;<a href="https://bugzilla.mozilla.org/buglist.cgi?regetlastlist=1">Show last search results</a>
</div>

<br>
</div>



<div id="footer">
  <div class="intro"></div>




<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="https://bugzilla.mozilla.org/">Home</a></li>
  <li><span class="separator">| </span><a href="https://bugzilla.mozilla.org/enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="https://bugzilla.mozilla.org/describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="https://bugzilla.mozilla.org/query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get" onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input class="txt" id="quicksearch_bottom" name="quicksearch" type="text">
    <input class="btn" value="Search" id="find_bottom" type="submit"></form>
  <a href="https://bugzilla.mozilla.org/page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="https://bugzilla.mozilla.org/report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="https://bugzilla.mozilla.org/request.cgi?requester=naj5c%40virginia.edu&amp;requestee=naj5c%40virginia.edu&amp;do_union=1&amp;group=type&amp;action=queue">My Requests</a></li>

    <li><span class="separator">| </span><a href="https://bugzilla.mozilla.org/userprefs.cgi">Preferences</a></li>
<li>
        <span class="separator">| </span>
        <a href="http://www.bugzilla.org/docs/3.6/en/html/bug_page.html" target="_blank">Help</a>
      </li>

    <li>
      <span class="separator">| </span>
        <a href="https://bugzilla.mozilla.org/index.cgi?logout=1">Log&nbsp;out</a>
        naj5c@virginia.edu</li>
</ul>
  </li>

  
    
    <li id="links-saved">
      <ul class="links">
          <li><a href="https://bugzilla.mozilla.org/buglist.cgi?bug_status=UNCONFIRMED&amp;bug_status=NEW&amp;bug_status=ASSIGNED&amp;bug_status=REOPENED&amp;emailassigned_to1=1&amp;emailreporter1=1&amp;emailtype1=exact&amp;email1=naj5c%40virginia.edu&amp;field0-0-0=bug_status&amp;type0-0-0=notequals&amp;value0-0-0=UNCONFIRMED&amp;field0-0-1=reporter&amp;type0-0-1=equals&amp;value0-0-1=naj5c%40virginia.edu">My Bugs</a></li>

      </ul>
    </li>

  


  
</ul>

  <div class="outro"></div>
</div>

</body></html>